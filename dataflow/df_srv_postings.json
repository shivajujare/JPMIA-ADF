{
	"name": "df_srv_postings",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_jpmia_raw_companies",
						"type": "DatasetReference"
					},
					"name": "contractPostings"
				},
				{
					"dataset": {
						"referenceName": "ds_jpmia_raw_companies",
						"type": "DatasetReference"
					},
					"name": "fullTimeJobPostings"
				},
				{
					"dataset": {
						"referenceName": "ds_jpmia_raw_companies",
						"type": "DatasetReference"
					},
					"name": "internshipJobPostings"
				},
				{
					"dataset": {
						"referenceName": "ds_jpmia_raw_companies",
						"type": "DatasetReference"
					},
					"name": "otherJobPostings"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_jpmia_source_view",
						"type": "DatasetReference"
					},
					"name": "jobPostings"
				}
			],
			"transformations": [
				{
					"name": "combineSources"
				}
			],
			"scriptLines": [
				"source(output(",
				"          job_id as string,",
				"          company_id as string,",
				"          title as string,",
				"          description as string,",
				"          max_salary as string,",
				"          med_salary as string,",
				"          min_salary as string,",
				"          pay_period as string,",
				"          formatted_work_type as string,",
				"          location as string,",
				"          applies as string,",
				"          original_listed_time as string,",
				"          remote_allowed as string,",
				"          views as string,",
				"          job_posting_url as string,",
				"          application_url as string,",
				"          application_type as string,",
				"          expiry as string,",
				"          closed_time as string,",
				"          formatted_experience_level as string,",
				"          skills_desc as string,",
				"          listed_time as string,",
				"          posting_domain as string,",
				"          sponsored as string,",
				"          work_type as string,",
				"          currency as string,",
				"          compensation_type as string,",
				"          scraped as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     multiLineRow: true,",
				"     wildcardPaths:[(concat('postings/', 'contract_job_postings.csv'))]) ~> contractPostings",
				"source(output(",
				"          job_id as string,",
				"          company_id as string,",
				"          title as string,",
				"          description as string,",
				"          max_salary as string,",
				"          med_salary as string,",
				"          min_salary as string,",
				"          pay_period as string,",
				"          formatted_work_type as string,",
				"          location as string,",
				"          applies as string,",
				"          original_listed_time as string,",
				"          remote_allowed as string,",
				"          views as string,",
				"          job_posting_url as string,",
				"          application_url as string,",
				"          application_type as string,",
				"          expiry as string,",
				"          closed_time as string,",
				"          formatted_experience_level as string,",
				"          skills_desc as string,",
				"          listed_time as string,",
				"          posting_domain as string,",
				"          sponsored as string,",
				"          work_type as string,",
				"          currency as string,",
				"          compensation_type as string,",
				"          scraped as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     multiLineRow: true,",
				"     wildcardPaths:[(concat('postings/', 'full_time_job_postings.csv'))]) ~> fullTimeJobPostings",
				"source(output(",
				"          job_id as string,",
				"          company_id as string,",
				"          title as string,",
				"          description as string,",
				"          max_salary as string,",
				"          med_salary as string,",
				"          min_salary as string,",
				"          pay_period as string,",
				"          formatted_work_type as string,",
				"          location as string,",
				"          applies as string,",
				"          original_listed_time as string,",
				"          remote_allowed as string,",
				"          views as string,",
				"          job_posting_url as string,",
				"          application_url as string,",
				"          application_type as string,",
				"          expiry as string,",
				"          closed_time as string,",
				"          formatted_experience_level as string,",
				"          skills_desc as string,",
				"          listed_time as string,",
				"          posting_domain as string,",
				"          sponsored as string,",
				"          work_type as string,",
				"          currency as string,",
				"          compensation_type as string,",
				"          scraped as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     multiLineRow: true,",
				"     wildcardPaths:[(concat('postings/', 'internship_job_postings.csv'))]) ~> internshipJobPostings",
				"source(output(",
				"          job_id as string,",
				"          company_id as string,",
				"          title as string,",
				"          description as string,",
				"          max_salary as string,",
				"          med_salary as string,",
				"          min_salary as string,",
				"          pay_period as string,",
				"          formatted_work_type as string,",
				"          location as string,",
				"          applies as string,",
				"          original_listed_time as string,",
				"          remote_allowed as string,",
				"          views as string,",
				"          job_posting_url as string,",
				"          application_url as string,",
				"          application_type as string,",
				"          expiry as string,",
				"          closed_time as string,",
				"          formatted_experience_level as string,",
				"          skills_desc as string,",
				"          listed_time as string,",
				"          posting_domain as string,",
				"          sponsored as string,",
				"          work_type as string,",
				"          currency as string,",
				"          compensation_type as string,",
				"          scraped as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     multiLineRow: true,",
				"     wildcardPaths:[(concat('postings/','other_job_postings.csv'))]) ~> otherJobPostings",
				"contractPostings, fullTimeJobPostings, internshipJobPostings, otherJobPostings union(byName: true,",
				"     partitionBy('hash', 1))~> combineSources",
				"combineSources sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:['job_postings.csv'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> jobPostings"
			]
		}
	}
}